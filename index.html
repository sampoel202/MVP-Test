<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Startup Diagnostic System</title>
    <script src="https://unpkg.com/docx@8.2.3/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #F0FDF4; color: #1F2937; margin: 0; }
        .container { max-width: 700px; margin: 40px auto; background: #fff; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.08); padding: 32px 24px; }
        .progress-bar { width: 100%; background: #eee; border-radius: 5px; height: 10px; margin-bottom: 24px; }
        .progress { height: 10px; background: linear-gradient(90deg, #0D9488, #F59E0B); border-radius: 5px; transition: width 0.3s; }
        .step { display: none; }
        .step.active { display: block; }
        .form-group { margin-bottom: 24px; }
        label { font-weight: 500; display: block; margin-bottom: 8px; }
        label.required::after { content: " *"; color: #DC2626; }
        input, select, textarea { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; font-size: 1rem; background-color: #F3F4F6; }
        .button-row { display: flex; justify-content: space-between; margin-top: 24px; }
        button { padding: 10px 24px; border: none; border-radius: 5px; background-color: #0D9488; color: #fff; font-size: 1rem; cursor: pointer; }
        button:hover { background-color: #0F766E; }
        button[disabled] { background: #ccc; cursor: not-allowed; }
        .results { background: #f8f9fa; border-radius: 8px; padding: 24px; margin-top: 32px; }
        .results h2 { color: #0D9488; }
        .hidden { display: none; }
        .success-message { background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .error-message { background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .consent-screen { text-align: center; padding: 40px 20px; max-width: 800px; margin: 0 auto; }
        .consent-screen h2 { color: #0D9488; margin-bottom: 20px; }
        .consent-screen p { margin-bottom: 30px; line-height: 1.6; }
        .consent-details { text-align: left; background: #f8f9fa; border-radius: 8px; padding: 24px; margin: 30px 0; border: 1px solid #e9ecef; }
        .consent-details h3 { color: #374151; margin: 20px 0 10px 0; font-size: 1.1rem; }
        .consent-details h3:first-child { margin-top: 0; }
        .consent-details ul { margin: 15px 0; padding-left: 20px; }
        .consent-details li { margin: 8px 0; line-height: 1.5; }
        .consent-details strong { color: #0D9488; }
        .consent-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 30px; }
        .consent-buttons button:first-child { background-color: #0D9488; }
        .consent-buttons button:last-child { background-color: #6B7280; }
        .metric-score { display: flex; align-items: center; margin: 10px 0; }
        .metric-score .label { flex: 1; }
        .metric-score .score { width: 100px; text-align: right; font-weight: bold; }
        .score-red { color: #DC2626; }
        .score-amber { color: #F59E0B; }
        .score-green { color: #059669; }
        .recommendations { background: #FEF3C7; border-left: 4px solid #F59E0B; padding: 15px; margin: 20px 0; }
        .other-input { margin-top: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <div id="consentScreen" class="consent-screen">
            <h2>Startup Diagnostic Assessment</h2>
            <p>Welcome! This diagnostic tool helps us understand your startup's current stage and identify areas where we can provide targeted support and guidance.</p>
            
            <div class="consent-details">
                <h3>What this involves:</h3>
                <ul>
                    <li><strong>26 questions</strong> about your business model, traction, and current challenges</li>
                    <li><strong>Stage assessment</strong> to determine where your startup fits in the growth journey</li>
                    <li><strong>Follow-up questions</strong> tailored to your startup's stage</li>
                    <li><strong>Personalised recommendations</strong> based on your specific situation</li>
                </ul>
                
                <h3>Data usage:</h3>
                <p>Your responses help us improve our support programmes and provide better guidance to other startups. We may use anonymised data for internal analysis and programme development.</p>
            </div>
            
            <div class="consent-buttons">
                <button onclick="startForm()">Start Diagnostic</button>
                <button onclick="window.location.href='https://google.com'">Not Now</button>
            </div>
        </div>
        
        <div id="mainForm" class="hidden">
            <h1>Startup Diagnostic - Initial Assessment</h1>
            <div class="progress-bar"><div class="progress" id="progress" style="width: 0%"></div></div>
            <form id="startupForm">
                <!-- Steps will be injected here by JS -->
            </form>
            <div class="results hidden" id="results"></div>
        </div>
    </div>
    <script>
        let currentStep = 1;
        let totalSteps = 26;
        let answers = {};
        let stageResult = {};
        let stageSpecificAnswers = {};
        let currentStageStep = 1;
        let totalStageSteps = 0;

        // All 26 questions in ORIGINAL ORDER with mandatory fields marked
        const questions = [
            { id: 1, label: "Founder Name", name: "founderName", type: "text", placeholder: "e.g. John Smith", required: true },
            { id: 2, label: "Email", name: "email", type: "email", placeholder: "e.g. john@company.com", required: true },
            { id: 3, label: "Company Name", name: "companyName", type: "text", placeholder: "e.g. TechStart Ltd", required: true },
            { id: 4, label: "Company Website", name: "companyWebsite", type: "url", placeholder: "https://yourcompany.com" },
            { id: 5, label: "In a few sentences, describe the opportunity and how your solution is best placed to address it?", name: "opportunitySolution", type: "textarea", placeholder: "Describe your opportunity and solution..." },
            { id: 6, label: "Why is now the right time to build the solution?", name: "whyNow", type: "textarea", placeholder: "Explain why now is the right time..." },
            { id: 7, label: "How clearly have you defined your target market and competitive edge at this stage?", name: "marketSizing", type: "select", options: [
                "We're still exploring — haven't clearly defined our target market or competitors yet.",
                "We have a rough idea of our target market and early signs of competitor activity.",
                "We've completed TAM/SAM/SOM sizing and identified key competitors.",
                "We have TAM/SAM/SOM + clear articulation of how we differ from existing solutions.",
                "We deeply understand market dynamics, supported by robust TAM/SAM/SOM + competitor analysis."
            ]},
            { id: 8, label: "Who is your target customer/user? Why are they a good fit for your solution?", name: "targetCustomer", type: "textarea", placeholder: "Describe your target customer..." },
            { id: 9, label: "How many paying customers or active users do you currently have?", name: "customers", type: "number", placeholder: "e.g. 25", required: true },
            { id: 10, label: "Roughly what % of your current customers or users are actively engaging with the product at least monthly?", name: "engagementQuality", type: "select", options: [
                "Not applicable", "Less than 10%", "10–30%", "30–60%", "Over 60%"
            ], required: true },
            { id: 11, label: "How are you currently acquiring your customers?", name: "goToMarket", type: "select", options: [
                "Haven't started acquiring yet", "Founder-led outreach or referrals", "Word of mouth / organic demand",
                "Paid marketing or ads", "Partnerships / channel sales", "Dedicated sales team or GTM function"
            ], required: true },
            { id: 12, label: "What best describes your primary business model?", name: "businessModel", type: "select", options: [
                "B2B (selling to businesses)", "B2C (selling to consumers)", "B2G (selling to government)",
                "Marketplace (buyers & sellers)", "Direct-to-Consumer (D2C)", "Subscription (e.g., SaaS)",
                "Consumer App", "Other (please specify)"
            ], required: true },
            { id: 13, label: "Which region is your company primarily operating in?", name: "region", type: "select", options: [
                "North America (US, Canada)", "Western Europe (e.g. UK, Germany, France, Nordics etc.)",
                "Australia & New Zealand", "Central & Eastern Europe", "Latin America", "Sub-Saharan Africa",
                "Middle East & North Africa (MENA)", "South Asia (e.g. India, Pakistan)",
                "Southeast Asia (e.g. Indonesia, Vietnam, Philippines)", "East Asia (e.g. China, Japan, Korea, Singapore)", "Other (please specify)"
            ], required: true },
            { id: 14, label: "Which category best describes your business type?", name: "businessType", type: "select", options: [
                "SaaS (Software as a Service)", "Marketplace (connecting buyers/sellers)", "E-commerce / DTC",
                "Hardware / Devices", "Services (e.g. consulting, agency)", "Platform / API-based",
                "Community or Content-led", "Other (please specify)"
            ], required: true },
            { id: 15, label: "What industry are you in?", name: "industry", type: "select", options: [
                "Software / SaaS", "Fintech / Insurtech", "Health / MedTech", "E-commerce / DTC",
                "Deep Tech / AI / Robotics", "Education / EdTech", "Social Impact / Nonprofit", "Other (please specify)"
            ], required: true },
            { id: 16, label: "What best describes the current state of your product?", name: "productReadiness", type: "select", options: [
                "Idea or concept only", "Wireframes / mockups", "MVP built (not in use)",
                "MVP being tested with early users", "Live product with active users",
                "Fully launched and scaled", "Not applicable / unknown"
            ], required: true },
            { id: 17, label: "What is your total revenue in the past 12 months (USD)?", name: "revenue", type: "number", placeholder: "e.g. 25000", required: true },
            { id: 18, label: "How many months of runway do you currently have based on your cash on hand and current burn?", name: "runway", type: "number", placeholder: "e.g. 6", step: "0.5", required: true },
            { id: 19, label: "How much funding have you raised to date (USD)?", name: "funding", type: "number", placeholder: "e.g. 100000", required: true },
            { id: 20, label: "Which of the following additional signals of traction or customer validation has your business achieved? (Select all that apply)", name: "tractionSignals", type: "checkbox", options: [
                "Pilot or beta programme completed with users", "Active user or customer engagement",
                "Signed commercial or strategic agreements (LOIs, MOUs, etc.)", "Channel partner actively generating leads",
                "10+ customer discovery interviews or UX tests", "Validation that changed product or GTM direction",
                "Qualified waitlist with warm intent", "Inbound partner or ecosystem interest",
                "Press, analyst, or ecosystem recognition", "Funnel metrics actively tracked", "None of the above"
            ]},
            { id: 21, label: "Outline the backgrounds of the founders in your business. Why are you best placed to make this solution work?", name: "founderProfiles", type: "textarea", placeholder: "Describe founder backgrounds and fit..." },
            { id: 22, label: "Including founders, how many people are currently on your team (full-time equivalents)?", name: "teamSize", type: "number", placeholder: "e.g. 3", min: "1", required: true },
            { id: 23, label: "What's the story behind how you started working on this business?", name: "teamStory", type: "textarea", placeholder: "Tell the story of how you started..." },
            { id: 24, label: "How are you currently identifying and addressing key risks or assumptions in the business?", name: "risksAssumptions", type: "select", options: [
                "We've started thinking through key risks and assumptions but haven't formalised anything yet.",
                "We've identified a few major assumptions (e.g. demand, pricing, team), and are working out how to test them.",
                "We're actively testing high-risk assumptions through user feedback, pilots, or experiments.",
                "We've validated core assumptions and now track remaining risks with basic systems or tools.",
                "We've built a systematic approach to monitoring and mitigating risks across functions (e.g. ops, product, compliance)."
            ]},
            { id: 25, label: "What goals are you looking to achieve over the coming 6 months with your business?", name: "goals", type: "checkbox", options: [
                "Launch a product or MVP with early users", "Test and validate solution with real users",
                "Acquire early customers or drive growth", "Raise investment", "Make key hires or build out the team",
                "Improve financial planning or extend runway", "Understand my ideal customer or positioning", "Other (please specify)"
            ]},
            { id: 26, label: "Anything else you think we should know about your business at this time?", name: "otherInformation", type: "textarea", placeholder: "Any additional information..." }
        ];

        // Stage-specific questions
        const stageQuestions = {
            "Ideation": [
                { label: "Which of the following best describes how you've defined and validated your initial customer segment?", name: "ideation_customer_profile", type: "select", options: [
                    "We haven't clearly defined our target customers yet.",
                    "We have a rough idea of who our customers might be, but haven't tested it.",
                    "We've had informal conversations with some potential customers.",
                    "We've conducted structured discovery with real potential customers and refined our understanding.",
                    "We have a clearly defined customer profile based on patterns validated through discovery conversations."
                ]},
                { label: "How clearly have you defined what your MVP needs to include — and why those features matter?", name: "ideation_mvp_scope", type: "select", options: [
                    "We haven't defined our MVP features or scope yet.",
                    "We've listed ideas, but haven't prioritised or linked them to the problem.",
                    "We have a rough MVP scope based on assumptions, not user input.",
                    "We've defined core features based on problem-solution fit and feasibility.",
                    "We've scoped our MVP tightly with a clear reason for each feature."
                ]},
                { label: "How well-defined is your business model at this stage?", name: "ideation_business_model", type: "select", options: [
                    "We have a clear business model – we know what we're selling, who pays, how they pay, and how it scales.",
                    "We have an initial business model and revenue logic, but still need to validate key assumptions.",
                    "We're still exploring different business model options or customer segments.",
                    "We have a broad idea, but haven't defined what we're selling or how it generates revenue.",
                    "We haven't focused on the business model yet."
                ]},
                { label: "How would you describe your current thinking around how to reach your early users or customers?", name: "ideation_gtm_thinking", type: "select", options: [
                    "We haven't thought much about GTM yet.",
                    "We have some rough GTM ideas but they're untested.",
                    "We've identified potential channels and pricing strategies to explore.",
                    "We've mapped early GTM hypotheses and started outlining experiments.",
                    "We have a clear GTM concept and a few experiments ready to test."
                ]},
                { label: "How well-positioned is your current team to deliver on the technical and product execution needed at this stage?", name: "ideation_team_technical", type: "select", options: [
                    "No one has relevant technical experience or product execution history.",
                    "One founder has some technical/product exposure.",
                    "Some relevant experience, but light in delivery track record.",
                    "Strong technical/product capability in-house.",
                    "Deep, proven experience building and launching similar products."
                ]},
                { label: "How well-positioned is your current team to deliver on the commercial and go-to-market execution needed at this stage?", name: "ideation_team_commercial", type: "select", options: [
                    "No commercial, sales, or growth experience in the team.",
                    "Some exposure to customer engagement or pitching.",
                    "One founder has decent experience in sales or marketing.",
                    "Clear experience driving early GTM or commercial traction.",
                    "Deep experience scaling early-stage GTM strategies."
                ]},
                { label: "How clearly have you defined your fundraising goals and demonstrated why you're ready to raise?", name: "ideation_fundraising_readiness", type: "select", options: [
                    "No clear funding need, unclear investor type or use of funds.",
                    "Vague understanding of funding need, minimal clarity on use of funds.",
                    "Funding target loosely defined, early sense of investor type and use.",
                    "Clear fundraising goal with identified investor type and planned use.",
                    "Defined raise, investor fit, MVP scope, and early need validation."
                ]},
                { label: "How clearly have you mapped out your near-term goals, milestones, and ways to track progress?", name: "ideation_milestones_progress", type: "select", options: [
                    "No milestones or future planning yet.",
                    "General ideas, but no clear timelines or owners.",
                    "Clear goals for next 2–3 months.",
                    "Defined milestones with timelines.",
                    "Shared roadmap with stakeholders and tracking in place."
                ]}
            ],
            "Validation": [
                { label: "How have you validated that your solution addresses a real user need?", name: "validation_solution_value", type: "select", options: [
                    "We've tested the solution with real users and can show strong engagement, retention, or conversion metrics.",
                    "We've received direct feedback from users confirming the value of our solution.",
                    "We've seen repeat usage or buying intent from early users.",
                    "We've conducted informal testing or pilots but haven't gathered structured evidence yet.",
                    "We haven't tested the solution with real users yet."
                ]},
                { label: "How would you describe the way potential customers are engaging with your solution or problem space?", name: "validation_icp_behaviour", type: "select", options: [
                    "We've had no meaningful engagement from potential customers yet.",
                    "We've had early chats but no strong evidence of interest.",
                    "A few have shown interest but it's inconsistent or unclear.",
                    "We're seeing repeated interest or intent signals from a clear profile.",
                    "We have strong and consistent behavioural signals that align with our ICP."
                ]},
                { label: "How well do you understand which segments and channels are gaining the most traction — and how your offering compares to competitors?", name: "validation_segment_traction", type: "select", options: [
                    "We've done little to no tracking of segments, channels, or competitors yet.",
                    "We've seen some early signs of traction in certain segments or channels, but haven't dug deep.",
                    "We've started analysing which segments or channels work, and have noted some competitor patterns.",
                    "We have a solid handle on which segments and channels are performing, with some competitor insight.",
                    "We have deep insight into segment traction, channel effectiveness, and how we're positioned vs competitors."
                ]},
                { label: "What have you learned from MVP testing — and how ready are you to deliver and support it at scale?", name: "validation_mvp_testing", type: "select", options: [
                    "We haven't tested the MVP yet, or it's too early to assess.",
                    "We've started basic testing, but key usability issues and delivery risks remain unresolved.",
                    "We've run some user testing and made basic improvements, but delivery systems still need work.",
                    "We've refined the MVP based on testing and have a clear roadmap for delivery and support.",
                    "MVP is well-tested with improvements made, and we're confident in our ability to deliver and support at scale."
                ]},
                { label: "How would you describe the experiments or strategies you've tested to find effective ways to reach your customers?", name: "validation_gtm_experimentation", type: "select", options: [
                    "We haven't run any GTM experiments yet.",
                    "We've run a few GTM tests but haven't learned much.",
                    "Some GTM experiments have shown promising signals.",
                    "We're seeing patterns around what works in messaging or channels.",
                    "We have clear learnings guiding our GTM strategy."
                ]},
                { label: "How would you describe the user behaviour or traction signals you're currently seeing — and what they indicate?", name: "validation_traction_signals", type: "select", options: [
                    "We haven't seen meaningful engagement or usage patterns yet.",
                    "We've seen isolated user activity but not enough to identify a pattern.",
                    "Some early traction is emerging but it's unclear what it means.",
                    "We're seeing repeated usage or behaviours that align with our problem-solution fit.",
                    "We have consistent traction signals that clearly validate product–market alignment."
                ]},
                { label: "Where do you currently stand in identifying and addressing key capability gaps (e.g. tech, marketing, operations)?", name: "validation_resource_gaps", type: "select", options: [
                    "We have major capability gaps and no clear plan to fill them.",
                    "We know we're missing key skills, but only starting to figure out next steps.",
                    "Some gaps exist, and we're loosely working on them.",
                    "Minor gaps remain — we've prioritised key hires or solutions.",
                    "We've mapped resourcing needs clearly and are actively filling them."
                ]},
                { label: "Beyond your current revenue, have you mapped out a clear financial plan for growth — including your projected revenue, funding use, and any early signs of efficiency?", name: "validation_financial_planning", type: "select", options: [
                    "No financial projections or plans for funding use yet.",
                    "Basic ideas exist but unclear or disconnected from goals.",
                    "Have started modeling revenue and planning use of funds, but still rough.",
                    "Revenue projections and funding plan are defined with some tested assumptions.",
                    "Clear financial model with 12–18 month projections, allocation plan, and early efficiency metrics (CAC, payback)."
                ]},
                { label: "How well prepared are you for raising your next round of funding? (Consider your pitch narrative, investor profile, funding goals, and supporting materials.)", name: "validation_fundraising_preparation", type: "select", options: [
                    "We haven't defined a narrative or target investor profile yet.",
                    "We've drafted a basic narrative but haven't tested or refined it.",
                    "We have a clear narrative and pitch, but still identifying the right investors.",
                    "We've defined our investor profile and have supporting pitch materials ready.",
                    "We're actively engaging investors with a strong, tested narrative and clear ask."
                ]},
                { label: "How clearly have you defined your early targets (e.g. users, revenue, engagement) — and tested the assumptions that matter most right now (like demand or pricing)?", name: "validation_risk_assumption_review", type: "select", options: [
                    "We haven't defined clear targets or tested key assumptions yet.",
                    "We've defined a few targets, but they're vague and assumptions are mostly untested.",
                    "We've defined specific goals, and have started testing key assumptions.",
                    "Our targets are clear and based on structured assumption testing (e.g. pricing, demand).",
                    "We've validated core assumptions and use our targets to guide focused execution."
                ]}
            ],
            "Early Traction": [
                { label: "How would you describe your understanding of how customers are using and staying engaged with your product or service?", name: "early_traction_customer_retention", type: "select", options: [
                    "We don't yet track how customers use or stay with our product.",
                    "We occasionally review some usage data but it's not consistent.",
                    "We have basic retention or usage data but limited analysis.",
                    "We track usage and retention systematically and review patterns.",
                    "We have a clear view of retention trends and identify expansion signals."
                ]},
                { label: "Which customer segments are showing the strongest traction, and how are you responding to competitive shifts or market demand signals?", name: "early_traction_market_signals", type: "select", options: [
                    "We haven't identified clear pull from any segment yet.",
                    "Some signs of interest from certain segments, but it's early and inconsistent.",
                    "Clear pull from one or two segments, but we haven't adapted positioning or messaging yet.",
                    "Strong pull from specific segments, and we're beginning to adjust positioning.",
                    "Clear segment traction and refined positioning based on competitor moves and market dynamics."
                ]},
                { label: "How well is your product performing with real users — and is your tech ready to scale with them?", name: "early_traction_product_usage", type: "select", options: [
                    "We're still collecting usage feedback and haven't addressed any scaling issues.",
                    "We've identified some issues from users or usage spikes, but haven't acted on them.",
                    "We've addressed surface-level bugs or UX issues, but deeper usage or scaling risks remain.",
                    "We've improved key UX friction points and resolved core tech bottlenecks.",
                    "Our product is resonating with users and our systems are handling growth without issues."
                ]},
                { label: "How clearly have you defined your go-to-market system — including your sales/marketing funnel, channel tests, and how you're learning what resonates with customers?", name: "early_traction_gtm_execution", type: "select", options: [
                    "We haven't structured GTM efforts yet.",
                    "We're experimenting but don't have a clear system.",
                    "We have a basic funnel and run some GTM tests.",
                    "We actively learn from funnel data and messaging experiments.",
                    "We have a repeatable GTM system with clear insights by segment."
                ]},
                { label: "What systems or processes have you established to support delivery and team scalability?", name: "early_traction_ops_scalability", type: "select", options: [
                    "No systems or defined processes yet.",
                    "Some informal processes in place, but inconsistent.",
                    "Defined lightweight systems or tools in early use.",
                    "Clear ownership of ops/CS/QA roles and basic delivery metrics tracked.",
                    "Processes and metrics (SLAs, NPS, resolution time) actively used to manage performance."
                ]},
                { label: "How well have you addressed your startup's basic legal and compliance responsibilities?", name: "early_traction_legal_compliance", type: "select", options: [
                    "Haven't reviewed legal or compliance requirements.",
                    "Basic IP/contracts reviewed but nothing formal.",
                    "Some key documents in place (e.g. NDAs).",
                    "Legal docs mostly ready, and sector-specific compliance considered.",
                    "All key legal docs in place and compliance risks identified and addressed."
                ]},
                { label: "How clearly can you see that users are getting value from your product — and moving toward becoming paying customers?", name: "early_traction_activation_monetization", type: "select", options: [
                    "We haven't defined what 'value' means yet.",
                    "Some users get value, but few convert to paying.",
                    "There's early signs of both value and conversion.",
                    "A decent % of users convert and stick.",
                    "Strong value delivery and reliable monetisation."
                ]},
                { label: "What capability or capacity gaps could hold back your next phase of execution, and how are you addressing them?", name: "early_traction_capability_gaps", type: "select", options: [
                    "Team under pressure — struggling to deliver current roadmap.",
                    "Major gaps limiting progress — no clear plan to solve.",
                    "Clear capability gaps, actively hiring or partnering to fill them.",
                    "Minor gaps in specific roles or skills, already planning to address.",
                    "No major gaps — team is resourced and executing well."
                ]},
                { label: "How are you building culture and supporting team performance as your team begins to scale?", name: "early_traction_people_culture", type: "select", options: [
                    "No real onboarding or cultural practices in place.",
                    "Ad hoc onboarding; no performance feedback yet.",
                    "Starting to define culture; some onboarding basics in place.",
                    "Onboarding process and informal feedback exist.",
                    "Strong culture-building; onboarding and feedback systems actively used."
                ]},
                { label: "How well developed is your financial planning — including your revenue model and ability to forecast different paths forward?", name: "early_traction_financial_planning", type: "select", options: [
                    "No real forecasting or financial planning in place.",
                    "Very rough estimates; limited link to actual performance.",
                    "Have some projections and a working revenue model, but not updated regularly.",
                    "Forecasts are updated with real data; strategy includes burn and revenue streams.",
                    "Financial plan is dynamic — includes updated burn, revenue projections, and multiple scenarios."
                ]},
                { label: "How well developed is your investment story and fundraising process? (Consider traction data, proof points, investor targeting, and outreach process.)", name: "early_traction_investment_narrative", type: "select", options: [
                    "We haven't started refining our story or identifying investors yet.",
                    "We've drafted our pitch narrative but have limited traction or proof points.",
                    "We've pulled together traction data and know the types of investors to target.",
                    "We have clear proof points and are actively targeting aligned investors with a defined outreach process.",
                    "We're engaging investors with a compelling narrative, solid metrics, and structured outreach."
                ]},
                { label: "How clearly have you mapped out your growth priorities for the next few months and aligned your team around them?", name: "early_traction_strategic_planning", type: "select", options: [
                    "No clear priorities or alignment yet.",
                    "Some general priorities identified, but not shared across team.",
                    "Priorities defined and loosely tracked.",
                    "Priorities linked to goals and timelines.",
                    "Shared, tracked plan with clear ownership and alignment"
                ]},
                { label: "How confident are you that your startup is ready to scale — from a tech, team, and operations standpoint?", name: "early_traction_scale_readiness", type: "select", options: [
                    "We haven't assessed scale readiness yet.",
                    "We see some blockers, but haven't addressed them.",
                    "We've started resolving key issues.",
                    "Most blockers addressed, some plans in place.",
                    "Fully confident — we're structurally ready to grow"
                ]}
            ],
            "Growth": [
                { label: "How would you describe your current approach to ensuring customers are retained, supported, and expanding over time?", name: "growth_customer_retention", type: "select", options: [
                    "We don't have any structured customer success or retention strategy.",
                    "We respond to issues reactively but don't track success or outcomes.",
                    "We have some customer-facing support processes but they're inconsistent.",
                    "We've defined success outcomes and actively work to retain and expand customers.",
                    "We have a structured customer success system with retention and expansion goals, tactics, and tracking in place."
                ]},
                { label: "How clearly are you differentiating from competitors in your positioning, and how often do you adapt your messaging as the market evolves?", name: "growth_competitive_differentiation", type: "select", options: [
                    "Our positioning isn't clearly differentiated and rarely updated.",
                    "We know who our competitors are, but our messaging doesn't strongly highlight our differences.",
                    "We highlight a few key differences, but our positioning needs sharpening.",
                    "We regularly track competitors and refine our messaging based on what we learn.",
                    "Our positioning is highly differentiated, updated often, and reinforced across GTM assets."
                ]},
                { label: "How well is your product scaling — both in terms of features for different users and system reliability under growth?", name: "growth_product_depth", type: "select", options: [
                    "Our product isn't scaling well and we haven't adapted features or infra for growth.",
                    "We've made basic improvements, but still face UX or system issues under load.",
                    "We've started expanding features or scaling infra, but there are still blockers.",
                    "We're expanding features based on segment feedback and strengthening systems.",
                    "Our product is scaling confidently across user types, and our systems are stable under growth."
                ]},
                { label: "How would you describe your current go-to-market engine — including your use of channels, ability to generate pipeline, and how effectively you're scaling GTM operations?", name: "growth_gtm_engine", type: "select", options: [
                    "GTM growth is still founder-led and inconsistent.",
                    "We have 1–2 working channels but no repeatable engine.",
                    "We have an emerging GTM system but it's not scalable yet.",
                    "We've built reliable GTM systems with early team/process scale.",
                    "We're confidently scaling pipeline, channels, and sales ops."
                ]},
                { label: "How effectively are your systems supporting scalable operations and team decision-making?", name: "growth_systems_tooling", type: "select", options: [
                    "No systems or automation in place.",
                    "Some tools used manually, but no integration or dashboards.",
                    "Basic automation or dashboards in limited use.",
                    "Repeatable systems in place across functions with visibility into ops.",
                    "Automated systems, shared dashboards, and low manual effort across key teams."
                ]},
                { label: "How prepared are you to manage regulatory and compliance risks across new markets or segments?", name: "growth_regulatory_compliance", type: "select", options: [
                    "No formal compliance planning.",
                    "Ad hoc legal posture reviews.",
                    "Identified key risks, with some compliance plans in place.",
                    "Compliance approach aligned to new markets or customer types.",
                    "Proactive compliance management across legal, regulatory, and security domains."
                ]},
                { label: "How well are you tracking and using data to understand whether your user or revenue growth is sustainable?", name: "growth_sustainable_metrics", type: "select", options: [
                    "We don't track retention or user quality.",
                    "We track some metrics but don't use them regularly.",
                    "We track and review retention and growth signals but rarely act on them.",
                    "We actively use growth and retention trends to guide product decisions.",
                    "We track cohorts, NPS, and funnel signals to guide growth investments."
                ]},
                { label: "How structured and scalable is your team's leadership, decision-making, and performance approach?", name: "growth_org_structure", type: "select", options: [
                    "No formal structure or leadership development.",
                    "Some informal leads but unclear roles or ownership.",
                    "Partial structure; limited leadership or feedback practices.",
                    "Defined structure and growing leadership maturity.",
                    "Strong leadership, structure, and performance culture."
                ]},
                { label: "How strong is your financial discipline in terms of growth forecasting, revenue strategy, and cost control?", name: "growth_financial_discipline", type: "select", options: [
                    "Forecasting is ad hoc and we don't update projections consistently.",
                    "Some visibility into revenue and spend, but no real growth planning or controls.",
                    "Basic revenue model and cost tracking in place, but not tightly linked to growth.",
                    "Strong forecasting with cost controls and evolving monetisation model.",
                    "Robust discipline — 12–24 month forecasts, cost controls, and optimised monetisation tied to growth segments."
                ]},
                { label: "How prepared are you for institutional fundraising and ongoing investor/board engagement? (Consider materials, metrics, board cadence, and reporting.)", name: "growth_institutional_fundraising", type: "select", options: [
                    "We haven't begun preparing for institutional investors or board engagement.",
                    "We've started gathering materials and discussing investor needs but still have key gaps.",
                    "We have the basics in place (e.g. deck, data room, investor conversations) and are engaging our board periodically.",
                    "We're actively engaging institutional investors and maintaining a consistent board/investor comms rhythm.",
                    "We're fully prepared for institutional rounds with clear reporting and board alignment."
                ]},
                { label: "How clearly have you defined your top strategic priorities — and are they visible, owned, and tracked across the team?", name: "growth_strategic_focus", type: "select", options: [
                    "No clear strategic priorities yet.",
                    "Some priorities defined, but not shared widely or tracked.",
                    "Priorities defined, with informal tracking.",
                    "Priorities tracked with some ownership.",
                    "Priorities linked to OKRs or roadmap, with ownership and team-wide alignment."
                ]},
                { label: "Have you begun developing a repeatable playbook for market, product, or segment expansion?", name: "growth_expansion_playbook", type: "select", options: [
                    "No expansion plans or activity yet.",
                    "Considering expansion options, but no structure.",
                    "Pilot efforts started with limited learnings.",
                    "Some repeatable success in early expansions.",
                    "Structured playbook with tracked KPIs, risks, and repeatability criteria"
                ]}
            ],
            "Scale": [
                { label: "How would you describe your approach to managing different customer segments and turning success into market influence?", name: "scale_enterprise_portfolio", type: "select", options: [
                    "We manage all customers the same and don't track outcomes.",
                    "We handle some customers differently but it's not strategic.",
                    "We've started segmenting customers and capturing some success stories.",
                    "We have a structured approach to segment management and track customer outcomes.",
                    "We run a portfolio model with segment-based playbooks, tracked outcomes, and use cases that support market credibility."
                ]},
                { label: "How clearly have you prioritised market segments across regions or verticals, and how are you tracking competitive shifts to inform positioning?", name: "scale_segment_strategy", type: "select", options: [
                    "We haven't clearly prioritised segments or tracked market dynamics.",
                    "We have basic segment ideas, but limited structure or consistency.",
                    "We're starting to prioritise segments regionally, but lack solid data or a consistent approach.",
                    "We've defined priority segments and adapt strategy with some monitoring of competitor/category shifts.",
                    "We've mapped core/emerging segments by region and track category shifts to refine global positioning."
                ]},
                { label: "How prepared are you for international expansion in terms of market insights, sequencing, and local team enablement?", name: "scale_market_intelligence", type: "select", options: [
                    "We haven't explored international expansion or done any research.",
                    "We've done some initial thinking but no structured market analysis or planning.",
                    "We've identified priority markets and have begun some research or basic frameworks.",
                    "We've defined a market entry strategy and built frameworks for sequencing and risk.",
                    "We have a defined strategy, regular intelligence gathering, and enablement systems for local teams."
                ]},
                { label: "How prepared is your product to scale as a platform — and deliver value reliably across a broad customer base?", name: "scale_platform_ecosystem", type: "select", options: [
                    "We're not yet thinking about extensibility, scale, or enterprise reliability.",
                    "We've made early efforts, but gaps remain in platform readiness and system stability.",
                    "We're working on APIs/integrations or infra improvements, but customer impact is inconsistent.",
                    "We've launched platform elements and improved system reliability for key segments.",
                    "Our product delivers consistent value at scale, with strong platform infrastructure and extensibility."
                ]},
                { label: "How are you scaling your go-to-market strategy across different regions, channels, or customer types?", name: "scale_international_gtm", type: "select", options: [
                    "We haven't adapted GTM strategy for scale yet.",
                    "We've started thinking about channels or regions but not executing.",
                    "We're testing new GTM strategies in a few areas.",
                    "We're executing targeted strategies across multiple segments.",
                    "We have tailored GTM execution across markets, channels, and buyer types."
                ]},
                { label: "How well have you institutionalised systems and processes to ensure consistent, high-quality delivery across regions and functions?", name: "scale_enterprise_systems", type: "select", options: [
                    "We're still mostly relying on ad hoc tools or informal processes across key functions.",
                    "We've introduced some systems and defined processes, but consistency and oversight vary by team or region.",
                    "We've implemented key systems and standardised delivery workflows, with some tracking in place.",
                    "Our systems, processes, and governance frameworks are consistent across functions, with performance tracking in place.",
                    "We have enterprise-grade systems, clearly defined governance, and full visibility into delivery quality and operations globally."
                ]},
                { label: "How well does your team use centralized data to inform planning and decision-making at scale?", name: "scale_central_data_platform", type: "select", options: [
                    "We use centralized, reliable data and dashboards to support strategic planning, forecasting, and real-time decisions across functions.",
                    "We have dashboards and models in place for some areas (e.g., finance or GTM), but not consistently across the org.",
                    "We've started centralizing key data, but usage is mostly limited to reporting – not proactive planning.",
                    "We track some data manually or in silos, but we don't use it to guide strategic decisions.",
                    "We don't yet have centralized data infrastructure or planning models."
                ]},
                { label: "How clearly are you identifying and improving the leverage points across your business — like sales efficiency, operational cost, or margins?", name: "scale_business_leverage", type: "select", options: [
                    "We haven't assessed these yet.",
                    "We've looked at some, but not tracked them consistently.",
                    "We've started tracking a few key ratios or team efficiencies.",
                    "We actively track cost/margin and adjust operations.",
                    "We benchmark and optimise across multiple business functions."
                ]},
                { label: "How well are you evolving your leadership team, succession plans, and org structure for long-term scale?", name: "scale_org_design", type: "select", options: [
                    "No formal succession or leadership scaling efforts.",
                    "Informal structure with unclear ownership or long-term planning.",
                    "Early discussions on succession/org design.",
                    "Defined ownership + starting LTIP/talent planning.",
                    "Clear succession, LTIP, and scalable org in place."
                ]},
                { label: "How would you describe your maturity in financial control, capital allocation, and forecasting sustainability at scale?", name: "scale_capital_allocation", type: "select", options: [
                    "No formal capital allocation or reporting processes yet.",
                    "Budgeting exists, but we don't track actuals vs. forecasts in detail.",
                    "Some controls in place — forecasts, board reporting, and audit prep started.",
                    "Strong systems — regular board packs, cap efficiency metrics, financial controls.",
                    "Full maturity — disciplined capital allocation, audit readiness, and efficient scaling with investor-grade reporting."
                ]},
                { label: "How well-prepared is your company for long-term strategic options — and how effectively are you engaging your board on them?", name: "scale_strategic_optionality", type: "select", options: [
                    "No clear thinking on exits or strategic paths, minimal board engagement.",
                    "Some discussions started, but no structured planning.",
                    "Options loosely defined, early board involvement.",
                    "Defined strategic paths, regular board input.",
                    "Strategic paths planned with metrics and active board alignment"
                ]},
                { label: "How intentionally are you using partnerships or acquisitions to accelerate scale?", name: "scale_inorganic_growth", type: "select", options: [
                    "We're actively executing strategic partnerships or acquisitions with structured frameworks in place (e.g., due diligence, integration, success metrics).",
                    "We've identified potential partners or targets and are preparing internal capabilities to act.",
                    "We're exploring inorganic options but haven't made structured plans yet.",
                    "We aren't currently pursuing partnerships or M&A as part of our growth strategy.",
                    "We don't see partnerships or acquisitions playing a role for us in the foreseeable future."
                ]}
            ]
        };

        // Initialize form
        function startForm() {
            document.getElementById('consentScreen').style.display = 'none';
            document.getElementById('mainForm').style.display = 'block';
            initializeForm();
        }

        function initializeForm() {
            const form = document.getElementById('startupForm');
            form.innerHTML = '';
            
            questions.forEach((question, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = `step ${index === 0 ? 'active' : ''}`;
                stepDiv.id = `step${index + 1}`;
                
                stepDiv.innerHTML = `
                    <h2>Question ${index + 1} of ${questions.length}</h2>
                    <div class="form-group">
                        <label for="${question.name}" class="${question.required ? 'required' : ''}">${question.label}</label>
                        ${generateInput(question)}
                    </div>
                    <div class="button-row">
                        ${index > 0 ? '<button type="button" onclick="prevStep()">Back</button>' : '<div></div>'}
                        ${index < questions.length - 1 ? '<button type="button" onclick="nextStep()">Continue</button>' : '<button type="button" onclick="calculateStage()">Next Questions</button>'}
                    </div>
                `;
                
                form.appendChild(stepDiv);
            });
            
            updateProgress();
        }

        function generateInput(question) {
            switch(question.type) {
                case 'text':
                case 'email':
                case 'url':
                    return `<input type="${question.type}" id="${question.name}" name="${question.name}" placeholder="${question.placeholder || ''}" ${question.required ? 'required' : ''}>`;
                case 'number':
                    return `<input type="number" id="${question.name}" name="${question.name}" placeholder="${question.placeholder || ''}" ${question.min ? `min="${question.min}"` : ''} ${question.step ? `step="${question.step}"` : ''} ${question.required ? 'required' : ''}>`;
                case 'textarea':
                    return `<textarea id="${question.name}" name="${question.name}" placeholder="${question.placeholder || ''}" rows="4" ${question.required ? 'required' : ''}></textarea>`;
                case 'select':
                    let options = '<option value="">Please select...</option>';
                    question.options.forEach(option => {
                        options += `<option value="${option}">${option}</option>`;
                    });
                    let selectHtml = `<select id="${question.name}" name="${question.name}" ${question.required ? 'required' : ''} onchange="handleOtherOption(this)">${options}</select>`;
                    
                    // Add "Other" input field if the question has "Other" options
                    if (question.options.some(opt => opt.includes('Other'))) {
                        selectHtml += `<input type="text" id="${question.name}_other" name="${question.name}_other" placeholder="Please specify..." class="other-input" style="display: none;">`;
                    }
                    
                    return selectHtml;
                case 'checkbox':
                    let checkboxes = '';
                    question.options.forEach(option => {
                        checkboxes += `<label><input type="checkbox" name="${question.name}" value="${option}" onchange="handleOtherCheckbox(this)"> ${option}</label><br>`;
                    });
                    let checkboxHtml = `<div>${checkboxes}</div>`;
                    
                    // Add "Other" input field if the question has "Other" options
                    if (question.options.some(opt => opt.includes('Other'))) {
                        checkboxHtml += `<input type="text" id="${question.name}_other" name="${question.name}_other" placeholder="Please specify..." class="other-input" style="display: none;">`;
                    }
                    
                    return checkboxHtml;
                default:
                    return `<input type="text" id="${question.name}" name="${question.name}" ${question.required ? 'required' : ''}>`;
            }
        }

        function handleOtherOption(select) {
            const otherInput = document.getElementById(select.name + '_other');
            if (otherInput) {
                if (select.value.includes('Other')) {
                    otherInput.style.display = 'block';
                    otherInput.required = true;
                } else {
                    otherInput.style.display = 'none';
                    otherInput.required = false;
                    otherInput.value = '';
                }
            }
        }

        function handleOtherCheckbox(checkbox) {
            const otherInput = document.getElementById(checkbox.name + '_other');
            if (otherInput) {
                const checkboxes = document.querySelectorAll(`input[name="${checkbox.name}"]:checked`);
                const hasOther = Array.from(checkboxes).some(cb => cb.value.includes('Other'));
                
                if (hasOther) {
                    otherInput.style.display = 'block';
                    otherInput.required = true;
                } else {
                    otherInput.style.display = 'none';
                    otherInput.required = false;
                    otherInput.value = '';
                }
            }
        }

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }

        function showStep(stepNumber) {
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById(`step${stepNumber}`).classList.add('active');
            updateProgress();
        }

        function nextStep() {
            if (!validateCurrentStep()) {
                return;
            }
            
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function collectAnswers() {
            answers = {};
            questions.forEach(question => {
                if (question.type === 'checkbox') {
                    const checkboxes = document.querySelectorAll(`input[name="${question.name}"]:checked`);
                    let values = Array.from(checkboxes).map(cb => cb.value);
                    
                    // Handle "Other" option for checkboxes
                    const otherInput = document.getElementById(question.name + '_other');
                    if (otherInput && otherInput.style.display !== 'none' && otherInput.value) {
                        values = values.map(v => v.includes('Other') ? `Other: ${otherInput.value}` : v);
                    }
                    
                    answers[question.name] = values;
                } else {
                    const element = document.getElementById(question.name);
                    if (element) {
                        let value = element.value;
                        
                        // Handle "Other" option for selects
                        if (question.type === 'select' && value.includes('Other')) {
                            const otherInput = document.getElementById(question.name + '_other');
                            if (otherInput && otherInput.style.display !== 'none' && otherInput.value) {
                                value = `Other: ${otherInput.value}`;
                            }
                        }
                        
                        answers[question.name] = value;
                    }
                }
            });
        }

        function validateCurrentStep() {
            const currentQuestion = questions[currentStep - 1];
            if (!currentQuestion.required) return true;
            
            const element = document.getElementById(currentQuestion.name);
            if (!element) return true;
            
            if (currentQuestion.type === 'checkbox') {
                const checkboxes = document.querySelectorAll(`input[name="${currentQuestion.name}"]:checked`);
                if (checkboxes.length === 0) {
                    alert('Please select at least one option.');
                    return false;
                }
                
                // Check if "Other" is selected but no value provided
                const hasOther = Array.from(checkboxes).some(cb => cb.value.includes('Other'));
                if (hasOther) {
                    const otherInput = document.getElementById(currentQuestion.name + '_other');
                    if (otherInput && otherInput.style.display !== 'none' && !otherInput.value.trim()) {
                        alert('Please specify your "Other" option.');
                        return false;
                    }
                }
            } else {
                if (!element.value.trim()) {
                    alert('This field is required.');
                    element.focus();
                    return false;
                }
                
                // Check if "Other" is selected but no value provided
                if (currentQuestion.type === 'select' && element.value.includes('Other')) {
                    const otherInput = document.getElementById(currentQuestion.name + '_other');
                    if (otherInput && otherInput.style.display !== 'none' && !otherInput.value.trim()) {
                        alert('Please specify your "Other" option.');
                        return false;
                    }
                }
            }
            
            return true;
        }

        // Sophisticated scoring matrix based on business context
        const scoringMatrix = {
            'B2B': {
                'Tier1': {
                    'SaaS': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 60000, green: 300000 },
                            'Customers/Users': { red: 0, amber: 8, green: 40 },
                            'Funding Raised': { red: 0, amber: 350000, green: 3500000 },
                            'Team Size': { red: 0, amber: 4, green: 15 },
                            'Burn Rate/Runway': { red: 0, amber: 3, green: 7 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 80000, green: 400000 },
                            'Customers/Users': { red: 0, amber: 10, green: 50 },
                            'Funding Raised': { red: 0, amber: 500000, green: 5000000 },
                            'Team Size': { red: 0, amber: 5, green: 20 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 9 }
                        }
                    },
                    'Marketplace': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 75000, green: 375000 },
                            'Customers/Users': { red: 0, amber: 10, green: 50 },
                            'Funding Raised': { red: 0, amber: 350000, green: 3500000 },
                            'Team Size': { red: 0, amber: 5, green: 20 },
                            'Burn Rate/Runway': { red: 0, amber: 3, green: 7 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 80000, green: 400000 },
                            'Customers/Users': { red: 0, amber: 12, green: 60 },
                            'Funding Raised': { red: 0, amber: 500000, green: 5000000 },
                            'Team Size': { red: 0, amber: 6, green: 25 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 9 }
                        }
                    },
                    'Other': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 75000, green: 375000 },
                            'Customers/Users': { red: 0, amber: 7, green: 35 },
                            'Funding Raised': { red: 0, amber: 350000, green: 3500000 },
                            'Team Size': { red: 0, amber: 4, green: 18 },
                            'Burn Rate/Runway': { red: 0, amber: 3, green: 7 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 100000, green: 500000 },
                            'Customers/Users': { red: 0, amber: 9, green: 45 },
                            'Funding Raised': { red: 0, amber: 500000, green: 5000000 },
                            'Team Size': { red: 0, amber: 5, green: 22 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 9 }
                        }
                    }
                },
                'Tier2/3': {
                    'SaaS': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 37500, green: 187500 },
                            'Customers/Users': { red: 0, amber: 4, green: 20 },
                            'Funding Raised': { red: 0, amber: 210000, green: 2100000 },
                            'Team Size': { red: 0, amber: 3, green: 12 },
                            'Burn Rate/Runway': { red: 0, amber: 3, green: 5 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 50000, green: 250000 },
                            'Customers/Users': { red: 0, amber: 5, green: 25 },
                            'Funding Raised': { red: 0, amber: 300000, green: 3000000 },
                            'Team Size': { red: 0, amber: 4, green: 15 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 6 }
                        }
                    },
                    'Marketplace': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 37500, green: 187500 },
                            'Customers/Users': { red: 0, amber: 5, green: 25 },
                            'Funding Raised': { red: 0, amber: 210000, green: 2100000 },
                            'Team Size': { red: 0, amber: 3, green: 12 },
                            'Burn Rate/Runway': { red: 0, amber: 3, green: 5 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 50000, green: 250000 },
                            'Customers/Users': { red: 0, amber: 6, green: 30 },
                            'Funding Raised': { red: 0, amber: 300000, green: 3000000 },
                            'Team Size': { red: 0, amber: 4, green: 15 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 6 }
                        }
                    },
                    'Other': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 37500, green: 187500 },
                            'Customers/Users': { red: 0, amber: 4, green: 20 },
                            'Funding Raised': { red: 0, amber: 210000, green: 2100000 },
                            'Team Size': { red: 0, amber: 3, green: 12 },
                            'Burn Rate/Runway': { red: 0, amber: 3, green: 5 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 50000, green: 250000 },
                            'Customers/Users': { red: 0, amber: 5, green: 25 },
                            'Funding Raised': { red: 0, amber: 300000, green: 3000000 },
                            'Team Size': { red: 0, amber: 4, green: 15 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 6 }
                        }
                    }
                }
            },
            'B2C': {
                'Tier1': {
                    'SaaS': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 112500, green: 562500 },
                            'Customers/Users': { red: 0, amber: 60, green: 250 },
                            'Funding Raised': { red: 0, amber: 420000, green: 4200000 },
                            'Team Size': { red: 0, amber: 5, green: 25 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 10 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 120000, green: 600000 },
                            'Customers/Users': { red: 0, amber: 75, green: 300 },
                            'Funding Raised': { red: 0, amber: 600000, green: 6000000 },
                            'Team Size': { red: 0, amber: 6, green: 30 },
                            'Burn Rate/Runway': { red: 0, amber: 5, green: 12 }
                        }
                    },
                    'Marketplace': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 112500, green: 562500 },
                            'Customers/Users': { red: 0, amber: 75, green: 300 },
                            'Funding Raised': { red: 0, amber: 420000, green: 4200000 },
                            'Team Size': { red: 0, amber: 6, green: 30 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 10 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 150000, green: 750000 },
                            'Customers/Users': { red: 0, amber: 100, green: 400 },
                            'Funding Raised': { red: 0, amber: 600000, green: 6000000 },
                            'Team Size': { red: 0, amber: 7, green: 35 },
                            'Burn Rate/Runway': { red: 0, amber: 5, green: 12 }
                        }
                    },
                    'Other': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 90000, green: 400000 },
                            'Customers/Users': { red: 0, amber: 50, green: 200 },
                            'Funding Raised': { red: 0, amber: 420000, green: 4200000 },
                            'Team Size': { red: 0, amber: 5, green: 22 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 10 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 150000, green: 750000 },
                            'Customers/Users': { red: 0, amber: 60, green: 250 },
                            'Funding Raised': { red: 0, amber: 600000, green: 6000000 },
                            'Team Size': { red: 0, amber: 6, green: 28 },
                            'Burn Rate/Runway': { red: 0, amber: 5, green: 12 }
                        }
                    }
                },
                'Tier2/3': {
                    'SaaS': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 56250, green: 281250 },
                            'Customers/Users': { red: 0, amber: 40, green: 150 },
                            'Funding Raised': { red: 0, amber: 252000, green: 2520000 },
                            'Team Size': { red: 0, amber: 4, green: 16 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 6 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 75000, green: 375000 },
                            'Customers/Users': { red: 0, amber: 50, green: 200 },
                            'Funding Raised': { red: 0, amber: 360000, green: 3600000 },
                            'Team Size': { red: 0, amber: 5, green: 20 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 7 }
                        }
                    },
                    'Marketplace': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 56250, green: 281250 },
                            'Customers/Users': { red: 0, amber: 60, green: 250 },
                            'Funding Raised': { red: 0, amber: 252000, green: 2520000 },
                            'Team Size': { red: 0, amber: 4, green: 16 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 6 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 75000, green: 375000 },
                            'Customers/Users': { red: 0, amber: 75, green: 300 },
                            'Funding Raised': { red: 0, amber: 360000, green: 3600000 },
                            'Team Size': { red: 0, amber: 5, green: 20 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 7 }
                        }
                    },
                    'Other': {
                        'Lean': {
                            'Revenue': { red: 0, amber: 56250, green: 281250 },
                            'Customers/Users': { red: 0, amber: 40, green: 150 },
                            'Funding Raised': { red: 0, amber: 252000, green: 2520000 },
                            'Team Size': { red: 0, amber: 4, green: 16 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 6 }
                        },
                        'CapitalIntensive': {
                            'Revenue': { red: 0, amber: 60000, green: 300000 },
                            'Customers/Users': { red: 0, amber: 50, green: 200 },
                            'Funding Raised': { red: 0, amber: 360000, green: 3600000 },
                            'Team Size': { red: 0, amber: 5, green: 20 },
                            'Burn Rate/Runway': { red: 0, amber: 4, green: 7 }
                        }
                    }
                }
            }
        };

        function calculateStage() {
            collectAnswers();
            
            // Profile classification
            const businessModelMapping = {
                'B2B (selling to businesses)': 'B2B',
                'B2C (selling to consumers)': 'B2C',
                'B2G (selling to government)': 'B2B',
                'Marketplace (buyers & sellers)': 'B2B',
                'Direct-to-Consumer (D2C)': 'B2C',
                'Subscription (e.g., SaaS)': 'B2B',
                'Consumer App': 'B2C',
                'Other / Not Listed': 'B2B'
            };

            const regionMapping = {
                'North America (US, Canada)': 'Tier1',
                'Western Europe (e.g. UK, Germany, France, Nordics etc.)': 'Tier1',
                'Australia & New Zealand': 'Tier1',
                'East Asia (e.g. China, Japan, Korea, Singapore)': 'Tier1',
                'Central & Eastern Europe': 'Tier2/3',
                'Latin America': 'Tier2/3',
                'Sub-Saharan Africa': 'Tier2/3',
                'Middle East & North Africa (MENA)': 'Tier2/3',
                'South Asia (e.g. India, Pakistan)': 'Tier2/3',
                'Southeast Asia (e.g. Indonesia, Vietnam, Philippines)': 'Tier2/3',
                'Other': 'Tier2/3'
            };

            const businessTypeMapping = {
                'SaaS (Software as a Service)': 'SaaS',
                'Marketplace (connecting buyers/sellers)': 'Marketplace',
                'E-commerce / DTC': 'Other',
                'Hardware / Devices': 'Other',
                'Services (e.g. consulting, agency)': 'Other',
                'Platform / API-based': 'SaaS',
                'Community or Content-led': 'Other',
                'Other': 'Other'
            };

            const industryMapping = {
                'Software / SaaS': 'Lean',
                'Fintech / Insurtech': 'CapitalIntensive',
                'Health / MedTech': 'CapitalIntensive',
                'E-commerce / DTC': 'Lean',
                'Deep Tech / AI / Robotics': 'CapitalIntensive',
                'Education / EdTech': 'Lean',
                'Social Impact / Nonprofit': 'Lean',
                'Other': 'Lean'
            };

            const businessModel = businessModelMapping[answers.businessModel] || 'B2B';
            const region = regionMapping[answers.region] || 'Tier1';
            const businessType = businessTypeMapping[answers.businessType] || 'SaaS';
            const industry = industryMapping[answers.industry] || 'Lean';
            
            const profile = `${businessModel}_${region}_${businessType}_${industry}`;

            // Sophisticated contextual scoring using the matrix
            let totalScore = 0;
            let scoreCount = 0;
            let detailedScores = {};

            // Get the scoring thresholds for this business profile
            const thresholds = scoringMatrix[businessModel]?.[region]?.[businessType]?.[industry];
            
            if (thresholds) {
                // Score Revenue
                const revenue = parseFloat(answers.revenue) || 0;
                let revenueScore = 0;
                if (revenue >= thresholds['Revenue'].green) revenueScore = 9;
                else if (revenue >= thresholds['Revenue'].amber) revenueScore = 5;
                else revenueScore = 2;
                totalScore += revenueScore;
                scoreCount++;
                detailedScores.revenue = { value: revenue, score: revenueScore, thresholds: thresholds['Revenue'] };

                // Score Customers/Users
                const customers = parseFloat(answers.customers) || 0;
                let customersScore = 0;
                if (customers >= thresholds['Customers/Users'].green) customersScore = 9;
                else if (customers >= thresholds['Customers/Users'].amber) customersScore = 5;
                else customersScore = 2;
                totalScore += customersScore;
                scoreCount++;
                detailedScores.customers = { value: customers, score: customersScore, thresholds: thresholds['Customers/Users'] };

                // Score Funding Raised
                const funding = parseFloat(answers.funding) || 0;
                let fundingScore = 0;
                if (funding >= thresholds['Funding Raised'].green) fundingScore = 9;
                else if (funding >= thresholds['Funding Raised'].amber) fundingScore = 5;
                else fundingScore = 2;
                totalScore += fundingScore;
                scoreCount++;
                detailedScores.funding = { value: funding, score: fundingScore, thresholds: thresholds['Funding Raised'] };

                // Score Team Size
                const teamSize = parseFloat(answers.teamSize) || 1;
                let teamScore = 0;
                if (teamSize >= thresholds['Team Size'].green) teamScore = 9;
                else if (teamSize >= thresholds['Team Size'].amber) teamScore = 5;
                else teamScore = 2;
                totalScore += teamScore;
                scoreCount++;
                detailedScores.teamSize = { value: teamSize, score: teamScore, thresholds: thresholds['Team Size'] };

                // Score Burn Rate/Runway
                const runway = parseFloat(answers.runway) || 0;
                let runwayScore = 0;
                if (runway >= thresholds['Burn Rate/Runway'].green) runwayScore = 9;
                else if (runway >= thresholds['Burn Rate/Runway'].amber) runwayScore = 5;
                else runwayScore = 2;
                totalScore += runwayScore;
                scoreCount++;
                detailedScores.runway = { value: runway, score: runwayScore, thresholds: thresholds['Burn Rate/Runway'] };
            } else {
                // Fallback to simple scoring if profile not found
                const revenue = parseFloat(answers.revenue) || 0;
                const customers = parseFloat(answers.customers) || 0;
                const funding = parseFloat(answers.funding) || 0;
                const teamSize = parseFloat(answers.teamSize) || 1;
                const runway = parseFloat(answers.runway) || 0;

                if (revenue > 100000) totalScore += 9;
                else if (revenue > 50000) totalScore += 5;
                else totalScore += 2;
                scoreCount++;

                if (customers > 100) totalScore += 9;
                else if (customers > 50) totalScore += 5;
                else totalScore += 2;
                scoreCount++;

                if (funding > 1000000) totalScore += 9;
                else if (funding > 500000) totalScore += 5;
                else totalScore += 2;
                scoreCount++;

                if (teamSize > 10) totalScore += 9;
                else if (teamSize > 5) totalScore += 5;
                else totalScore += 2;
                scoreCount++;

                if (runway > 12) totalScore += 9;
                else if (runway > 6) totalScore += 5;
                else totalScore += 2;
                scoreCount++;
            }

            const averageScore = totalScore / scoreCount;

            // Stage mapping
            let stage = 'Ideation';
            if (averageScore >= 7.5) stage = 'Scale';
            else if (averageScore >= 6.5) stage = 'Growth';
            else if (averageScore >= 5.5) stage = 'Early Traction';
            else if (averageScore >= 4.5) stage = 'Validation';
            else stage = 'Ideation';

            // Apply caveats
            if (answers.productReadiness === 'Idea or concept only') {
                stage = 'Ideation';
            }

            if ((!answers.customers || parseFloat(answers.customers) === 0) && (!answers.revenue || parseFloat(answers.revenue) === 0)) {
                stage = 'Ideation';
            }

            stageResult = {
                stage: stage,
                score: averageScore.toFixed(2),
                profile: profile,
                detailedScores: detailedScores,
                thresholds: thresholds || null,
                businessContext: {
                    model: businessModel,
                    region: region,
                    type: businessType,
                    industry: industry
                },
                totalScore: totalScore,
                scoreCount: scoreCount
            };

            // Auto-redirect to stage-specific questions
            startStageQuestions();
        }

        function startStageQuestions() {
            // Hide initial form and results
            document.getElementById('startupForm').style.display = 'none';
            document.getElementById('results').style.display = 'none';
            
            // Update title
            document.querySelector('h1').textContent = 'Startup Diagnostic - Stage-Specific Questions';
            
            // Map transition stages to base stages
            const stageMapping = {
                'Ideation': 'Ideation',
                'Ideation → Validation': 'Ideation',
                'Validation': 'Validation',
                'Validation → Early Traction': 'Validation',
                'Early Traction': 'Early Traction',
                'Early Traction → Growth': 'Early Traction',
                'Growth': 'Growth',
                'Growth → Scale': 'Growth',
                'Scale': 'Scale'
            };
            
            const currentStage = stageMapping[stageResult.stage] || 'Ideation';
            const stageQuestionsList = stageQuestions[currentStage];
            
            if (stageQuestionsList) {
                totalStageSteps = stageQuestionsList.length;
                currentStageStep = 1;
                renderStageStep();
            }
        }

        function renderStageStep() {
            const stageMapping = {
                'Ideation': 'Ideation',
                'Ideation → Validation': 'Ideation',
                'Validation': 'Validation',
                'Validation → Early Traction': 'Validation',
                'Early Traction': 'Early Traction',
                'Early Traction → Growth': 'Early Traction',
                'Growth': 'Growth',
                'Growth → Scale': 'Growth',
                'Scale': 'Scale'
            };
            
            const currentStage = stageMapping[stageResult.stage] || 'Ideation';
            const stageQuestionsList = stageQuestions[currentStage];
            
            if (!stageQuestionsList) return;
            
            const question = stageQuestionsList[currentStageStep - 1];
            if (!question) return;
            
            const form = document.getElementById('startupForm');
            form.style.display = 'block';
            form.innerHTML = `
                <div class="form-group">
                    <label for="${question.name}">${question.label}</label>
                    ${generateInput(question)}
                </div>
                <div class="button-row">
                    ${currentStageStep > 1 ? '<button type="button" onclick="prevStageStep()">Back</button>' : '<div></div>'}
                    ${currentStageStep < totalStageSteps ? '<button type="button" onclick="nextStageStep()">Continue</button>' : '<button type="button" onclick="finishStageQuestions()">Finish</button>'}
                </div>
            `;
            
            // Update progress
            const progress = (currentStageStep / totalStageSteps) * 100;
            document.getElementById('progress').style.width = progress + '%';
            document.getElementById('progress').parentElement.previousElementSibling.textContent = `Stage-Specific Question ${currentStageStep} of ${totalStageSteps}`;
        }

        function nextStageStep() {
            saveStageAnswer();
            if (currentStageStep < totalStageSteps) {
                currentStageStep++;
                renderStageStep();
            }
        }

        function prevStageStep() {
            saveStageAnswer();
            if (currentStageStep > 1) {
                currentStageStep--;
                renderStageStep();
            }
        }

        function saveStageAnswer() {
            const stageMapping = {
                'Ideation': 'Ideation',
                'Ideation → Validation': 'Ideation',
                'Validation': 'Validation',
                'Validation → Early Traction': 'Validation',
                'Early Traction': 'Early Traction',
                'Early Traction → Growth': 'Early Traction',
                'Growth': 'Growth',
                'Growth → Scale': 'Growth',
                'Scale': 'Scale'
            };
            
            const currentStage = stageMapping[stageResult.stage] || 'Ideation';
            const stageQuestionsList = stageQuestions[currentStage];
            
            if (!stageQuestionsList) return;
            
            const question = stageQuestionsList[currentStageStep - 1];
            if (!question) return;
            
            const element = document.getElementById(question.name);
            if (element) {
                stageSpecificAnswers[question.name] = element.value;
            }
        }

        function finishStageQuestions() {
            saveStageAnswer();
            showStageResults();
        }

        function showStageResults() {
            const form = document.getElementById('startupForm');
            form.style.display = 'none';
            
            // Use the contextual scores from stageResult
            const detailedScores = stageResult.detailedScores || {};
            const thresholds = stageResult.thresholds;
            const businessContext = stageResult.businessContext;
            
            // Get scores from detailed analysis
            const revenueScore = detailedScores.revenue?.score || 2;
            const customersScore = detailedScores.customers?.score || 2;
            const fundingScore = detailedScores.funding?.score || 2;
            const teamScore = detailedScores.teamSize?.score || 2;
            const runwayScore = detailedScores.runway?.score || 2;
            
            // Generate contextual recommendations
            const recommendations = [];
            if (revenueScore <= 2) {
                const threshold = detailedScores.revenue?.thresholds;
                if (threshold) {
                    recommendations.push(`Focus on reaching £${threshold.amber.toLocaleString()} revenue (amber zone) to improve your score from ${revenueScore}/10`);
                } else {
                    recommendations.push("Focus on generating early revenue through pilot programmes or beta customers");
                }
            }
            if (customersScore <= 2) {
                const threshold = detailedScores.customers?.thresholds;
                if (threshold) {
                    recommendations.push(`Prioritise reaching ${threshold.amber} customers/users (amber zone) to improve your score from ${customersScore}/10`);
                } else {
                    recommendations.push("Prioritise customer acquisition and validation of your value proposition");
                }
            }
            if (fundingScore <= 2) {
                const threshold = detailedScores.funding?.thresholds;
                if (threshold) {
                    recommendations.push(`Consider raising £${(threshold.amber/1000000).toFixed(1)}M+ funding (amber zone) to improve your score from ${fundingScore}/10`);
                } else {
                    recommendations.push("Consider raising funding to accelerate growth and extend runway");
                }
            }
            if (teamScore <= 2) {
                const threshold = detailedScores.teamSize?.thresholds;
                if (threshold) {
                    recommendations.push(`Build your team to ${threshold.amber}+ people (amber zone) to improve your score from ${teamScore}/10`);
                } else {
                    recommendations.push("Build out your team with key hires to support growth");
                }
            }
            if (runwayScore <= 2) {
                const threshold = detailedScores.runway?.thresholds;
                if (threshold) {
                    recommendations.push(`Extend runway to ${threshold.amber}+ months (amber zone) to improve your score from ${runwayScore}/10`);
                } else {
                    recommendations.push("Extend your runway through cost optimisation or additional funding");
                }
            }
            
            const results = document.getElementById('results');
            results.style.display = 'block';
            results.innerHTML = `
                <div style="text-align: center; margin-bottom: 30px;">
                    <h2 style="color: #0D9488; font-size: 32px; margin-bottom: 10px;">🚀 STARTUP DIAGNOSTIC DASHBOARD</h2>
                    <p style="color: #6B7280; font-size: 18px;">Your complete performance analysis</p>
                </div>
                
                <!-- 3x2 Grid Dashboard -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <!-- Revenue -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 24px; margin-bottom: 15px;">💰</div>
                        <h4 style="margin: 0 0 15px 0; color: #374151;">REVENUE</h4>
                        <div class="gauge-container" style="margin: 20px 0; position: relative;">
                            <svg width="120" height="120" viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="50" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                                <circle cx="60" cy="60" r="50" fill="none" stroke="${revenueScore <= 2 ? '#ef4444' : revenueScore <= 5 ? '#f59e0b' : '#10b981'}" 
                                        stroke-width="8" stroke-dasharray="${(revenueScore/10) * 314}" stroke-dashoffset="0" 
                                        transform="rotate(-90 60 60)" stroke-linecap="round"/>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 18px; font-weight: bold; color: #374151;">
                                ${revenueScore}/10
                            </div>
                        </div>
                        <div style="font-size: 14px; color: ${revenueScore <= 2 ? '#ef4444' : revenueScore <= 5 ? '#f59e0b' : '#10b981'}; font-weight: bold; margin-bottom: 8px;">
                            ${revenueScore <= 2 ? 'Red Zone' : revenueScore <= 5 ? 'Amber Zone' : 'Green Zone'}
                        </div>

                    </div>
                    
                    <!-- Customers -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 24px; margin-bottom: 15px;">👥</div>
                        <h4 style="margin: 0 0 15px 0; color: #374151;">CUSTOMERS</h4>
                        <div class="gauge-container" style="margin: 20px 0; position: relative;">
                            <svg width="120" height="120" viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="50" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                                <circle cx="60" cy="60" r="50" fill="none" stroke="${customersScore <= 2 ? '#ef4444' : customersScore <= 5 ? '#f59e0b' : '#10b981'}" 
                                        stroke-width="8" stroke-dasharray="${(customersScore/10) * 314}" stroke-dashoffset="0" 
                                        transform="rotate(-90 60 60)" stroke-linecap="round"/>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 18px; font-weight: bold; color: #374151;">
                                ${customersScore}/10
                            </div>
                        </div>
                        <div style="font-size: 14px; color: ${customersScore <= 2 ? '#ef4444' : customersScore <= 5 ? '#f59e0b' : '#10b981'}; font-weight: bold; margin-bottom: 8px;">
                            ${customersScore <= 2 ? 'Red Zone' : customersScore <= 5 ? 'Amber Zone' : 'Green Zone'}
                        </div>

                    </div>
                    
                    <!-- Funding -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 24px; margin-bottom: 15px;">💸</div>
                        <h4 style="margin: 0 0 15px 0; color: #374151;">FUNDING</h4>
                        <div class="gauge-container" style="margin: 20px 0; position: relative;">
                            <svg width="120" height="120" viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="50" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                                <circle cx="60" cy="60" r="50" fill="none" stroke="${fundingScore <= 2 ? '#ef4444' : fundingScore <= 5 ? '#f59e0b' : '#10b981'}" 
                                        stroke-width="8" stroke-dasharray="${(fundingScore/10) * 314}" stroke-dashoffset="0" 
                                        transform="rotate(-90 60 60)" stroke-linecap="round"/>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 18px; font-weight: bold; color: #374151;">
                                ${fundingScore}/10
                            </div>
                        </div>
                        <div style="font-size: 14px; color: ${fundingScore <= 2 ? '#ef4444' : fundingScore <= 5 ? '#f59e0b' : '#10b981'}; font-weight: bold; margin-bottom: 8px;">
                            ${fundingScore <= 2 ? 'Red Zone' : fundingScore <= 5 ? 'Amber Zone' : 'Green Zone'}
                        </div>

                    </div>
                    
                    <!-- Team Size -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 24px; margin-bottom: 15px;">👨‍💼</div>
                        <h4 style="margin: 0 0 15px 0; color: #374151;">TEAM SIZE</h4>
                        <div class="gauge-container" style="margin: 20px 0; position: relative;">
                            <svg width="120" height="120" viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="50" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                                <circle cx="60" cy="60" r="50" fill="none" stroke="${teamScore <= 2 ? '#ef4444' : teamScore <= 5 ? '#f59e0b' : '#10b981'}" 
                                        stroke-width="8" stroke-dasharray="${(teamScore/10) * 314}" stroke-dashoffset="0" 
                                        transform="rotate(-90 60 60)" stroke-linecap="round"/>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 18px; font-weight: bold; color: #374151;">
                                ${teamScore}/10
                            </div>
                        </div>
                        <div style="font-size: 14px; color: ${teamScore <= 2 ? '#ef4444' : teamScore <= 5 ? '#f59e0b' : '#10b981'}; font-weight: bold; margin-bottom: 8px;">
                            ${teamScore <= 2 ? 'Red Zone' : teamScore <= 5 ? 'Amber Zone' : 'Green Zone'}
                        </div>

                    </div>
                    
                    <!-- Runway -->
                    <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                        <div style="font-size: 24px; margin-bottom: 15px;">⏰</div>
                        <h4 style="margin: 0 0 15px 0; color: #374151;">RUNWAY</h4>
                        <div class="gauge-container" style="margin: 20px 0; position: relative;">
                            <svg width="120" height="120" viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="50" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                                <circle cx="60" cy="60" r="50" fill="none" stroke="${runwayScore <= 2 ? '#ef4444' : runwayScore <= 5 ? '#f59e0b' : '#10b981'}" 
                                        stroke-width="8" stroke-dasharray="${(runwayScore/10) * 314}" stroke-dashoffset="0" 
                                        transform="rotate(-90 60 60)" stroke-linecap="round"/>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 18px; font-weight: bold; color: #374151;">
                                ${runwayScore}/10
                            </div>
                        </div>
                        <div style="font-size: 14px; color: ${runwayScore <= 2 ? '#ef4444' : runwayScore <= 5 ? '#f59e0b' : '#10b981'}; font-weight: bold; margin-bottom: 8px;">
                            ${runwayScore <= 2 ? 'Red Zone' : runwayScore <= 5 ? 'Amber Zone' : 'Green Zone'}
                        </div>

                    </div>
                    
                    <!-- Overall Score -->
                    <div style="background: linear-gradient(135deg, #0D9488, #0891b2); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; color: white;">
                        <div style="font-size: 24px; margin-bottom: 15px;">📊</div>
                        <h4 style="margin: 0 0 15px 0; color: white;">OVERALL</h4>
                        <div class="gauge-container" style="margin: 20px 0; position: relative;">
                            <svg width="120" height="120" viewBox="0 0 120 120">
                                <circle cx="60" cy="60" r="50" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="8"/>
                                <circle cx="60" cy="60" r="50" fill="none" stroke="white" 
                                        stroke-width="8" stroke-dasharray="${(parseFloat(stageResult.score)/10) * 314}" stroke-dashoffset="0" 
                                        transform="rotate(-90 60 60)" stroke-linecap="round"/>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 18px; font-weight: bold; color: white;">
                                ${stageResult.score}/10
                            </div>
                        </div>
                        <div style="font-size: 14px; color: rgba(255,255,255,0.9); font-weight: bold; margin-bottom: 8px;">
                            ${parseFloat(stageResult.score) >= 7 ? 'Excellent' : parseFloat(stageResult.score) >= 5 ? 'Good' : 'Developing'}
                        </div>
                    </div>
                </div>
                
                <!-- Stage and Score Summary -->
                <div style="background: linear-gradient(135deg, #1f2937, #374151); padding: 30px; border-radius: 16px; text-align: center; color: white; margin-bottom: 30px;">
                    <h2 style="margin: 0 0 15px 0; font-size: 28px; color: #fbbf24;">STAGE: ${stageResult.stage.toUpperCase()}</h2>
                    <div style="font-size: 48px; font-weight: bold; color: #10b981; margin-bottom: 10px;">${stageResult.score}/10</div>
                    <p style="margin: 0; color: #d1d5db; font-size: 16px;">Overall Performance Score</p>
                </div>
                
                <!-- Action Buttons -->
                <div style="text-align: center; margin-top: 30px;">
                    <button onclick="restartForm()" style="margin: 0 10px; padding: 12px 24px; border: none; border-radius: 8px; background: #6B7280; color: white; cursor: pointer; font-size: 16px;">Start Over</button>
                    <button onclick="exportCompleteData()" style="margin: 0 10px; padding: 12px 24px; border: none; border-radius: 8px; background: #0D9488; color: white; cursor: pointer; font-size: 16px;">Export Data</button>
                    <button onclick="submitToGoogleSheets()" style="margin: 0 10px; padding: 12px 24px; border: none; border-radius: 8px; background: #4285f4; color: white; cursor: pointer; font-size: 16px;">Submit to Google Sheets</button>
                    <button onclick="generateAIReport()" style="margin: 0 10px; padding: 12px 24px; border: none; border-radius: 8px; background: #10b981; color: white; cursor: pointer; font-size: 16px;">🤖 Generate AI Report</button>
                </div>
            `;
        }

        function restartForm() {
            currentStep = 1;
            answers = {};
            stageResult = {};
            stageSpecificAnswers = {};
            currentStageStep = 1;
            totalStageSteps = 0;
            
            document.getElementById('startupForm').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            document.querySelector('h1').textContent = 'Startup Diagnostic - Initial Assessment';
            
            // Reset form
            document.querySelectorAll('input, select, textarea').forEach(element => {
                if (element.type === 'checkbox' || element.type === 'radio') {
                    element.checked = false;
                } else {
                    element.value = '';
                }
            });
            
            initializeForm();
        }

        function exportCompleteData() {
            const data = {
                timestamp: new Date().toISOString(),
                initialAnswers: answers,
                stageResult: stageResult,
                stageSpecificAnswers: stageSpecificAnswers
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'startup-diagnostic-results.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function submitToGoogleSheets() {
            // Collect all data
            const data = {
                submissionDate: new Date().toLocaleDateString(),
                timestamp: new Date().toISOString(),
                founderName: answers.founderName || '',
                email: answers.email || '',
                companyName: answers.companyName || '',
                companyWebsite: answers.companyWebsite || '',
                calculatedStage: stageResult.stage,
                overallScore: stageResult.score,
                profile: stageResult.profile,
                opportunitySolution: answers.opportunitySolution || '',
                whyNow: answers.whyNow || '',
                marketSizing: answers.marketSizing || '',
                targetCustomer: answers.targetCustomer || '',
                customers: answers.customers || '',
                engagementQuality: answers.engagementQuality || '',
                goToMarket: answers.goToMarket || '',
                businessModel: answers.businessModel || '',
                region: answers.region || '',
                businessType: answers.businessType || '',
                industry: answers.industry || '',
                productReadiness: answers.productReadiness || '',
                revenue: answers.revenue || '',
                runway: answers.runway || '',
                funding: answers.funding || '',
                risksAssumptions: answers.risksAssumptions || '',
                tractionSignals: answers.tractionSignals || '',
                founderProfiles: answers.founderProfiles || '',
                teamSize: answers.teamSize || '',
                teamStory: answers.teamStory || '',
                goals: answers.goals || '',
                otherInformation: answers.otherInformation || '',
                ...stageSpecificAnswers
            };

            // Show loading state
            const results = document.getElementById('results');
            const existingContent = results.innerHTML;
            
            results.innerHTML = existingContent + `
                <div class="success-message">
                    <h3>Submitting to Google Sheets...</h3>
                    <p>Please wait while we submit your data...</p>
                </div>
            `;

            // Replace with your Google Apps Script web app URL
            const scriptUrl = 'https://script.google.com/macros/s/AKfycbx5FIulQupW6i3yTu7qOj0WLcXaFw_vbK8xUZ1iNhZ1zFvSl51ShamhENdEbjMjv-AB9A/exec';
            
            console.log('Submitting data:', data);
            console.log('Script URL:', scriptUrl);
            
            // Try to bypass CORS with a different approach
            const formData = new FormData();
            formData.append('data', JSON.stringify(data));
            
            // Add a timestamp to prevent caching
            const urlWithTimestamp = scriptUrl + '?t=' + Date.now();
            
            // Try a different approach - use a simple POST without complex headers
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = urlWithTimestamp;
            form.target = 'hidden-iframe';
            
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'data';
            input.value = JSON.stringify(data);
            form.appendChild(input);
            
            // Create hidden iframe to handle the response
            const iframe = document.createElement('iframe');
            iframe.name = 'hidden-iframe';
            iframe.style.display = 'none';
            document.body.appendChild(iframe);
            
            // Submit the form
            document.body.appendChild(form);
            form.submit();
            
            // Remove the form and iframe
            setTimeout(() => {
                document.body.removeChild(form);
                document.body.removeChild(iframe);
                
                // Show success message (since we can't read the response due to CORS)
                results.innerHTML = existingContent + `
                    <div class="success-message">
                        <h3>✅ Data Submitted Successfully!</h3>
                        <p><strong>Stage:</strong> ${stageResult.stage}</p>
                        <p><strong>Score:</strong> ${stageResult.score}/10</p>
                        <p><strong>Profile:</strong> ${stageResult.profile}</p>
                        <p><strong>Company:</strong> ${answers.companyName || 'N/A'}</p>
                        <p><strong>Email:</strong> ${answers.email || 'N/A'}</p>
                        <p><strong>Revenue:</strong> $${answers.revenue || '0'}</p>
                        <p><strong>Customers:</strong> ${answers.customers || '0'}</p>
                        <p><strong>Funding:</strong> $${answers.funding || '0'}</p>
                        <p><strong>Team Size:</strong> ${answers.teamSize || '1'}</p>
                        <p><strong>Runway:</strong> ${answers.runway || '0'} months</p>
                        <p><strong>Data has been submitted to Google Sheets.</strong></p>
                        <p><em>Note: Due to browser security restrictions, we cannot confirm the response, but the data has been sent.</em></p>
                    </div>
                `;
            }, 2000);
        }

        // Initialize - show consent screen first
        // initializeForm(); // This will be called after consent

        // AI Report Generation Functions
        function generateAIReport() {
            const results = document.getElementById('results');
            const existingContent = results.innerHTML;
            
            results.innerHTML = existingContent + `
                <div style="background: white; padding: 30px; border-radius: 16px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin: 30px 0;">
                    <h2 style="color: #10b981; text-align: center; margin-bottom: 30px;">🤖 AI-Powered Startup Report</h2>
                    
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">🚀 Startup Overview</h3>
                        <p style="color: #6b7280; line-height: 1.6;">Based on your diagnostic results, ${answers.companyName || 'your startup'} is currently in the ${stageResult.stage} stage with an overall performance score of ${stageResult.score}/10. This indicates your startup is in the ${stageResult.stage === 'Ideation' ? 'early conceptual phase' : stageResult.stage === 'Validation' ? 'problem-solution validation phase' : stageResult.stage === 'Early Traction' ? 'early customer acquisition phase' : stageResult.stage === 'Growth' ? 'scaling phase' : 'mature scaling phase'}.</p>
                    </div>
                    
                                                <div style="margin-bottom: 30px;">
                                <h3 style="color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">💡 Strategic Recommendations</h3>
                                <div style="background: #f8fafc; padding: 20px; border-radius: 8px;">
                                    <p style="color: #6b7280; margin-bottom: 20px; font-style: italic;">These recommendations are based on your answers to the stage-specific questions below. Each recommendation shows what you answered and our strategic advice for improvement.</p>
                                    ${generateRecommendations()}
                                </div>
                            </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="downloadAIReport()" style="background: #10b981; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; margin: 0 10px;">📥 Download Report</button>
                    </div>
                </div>
            `;
        }

        function generateRecommendations() {
            const stage = stageResult.stage;
            let recommendations = '';
            
            // Get the stage-specific questions for this stage
            const stageMapping = {
                'Ideation': 'Ideation',
                'Ideation → Validation': 'Ideation',
                'Validation': 'Validation',
                'Validation → Early Traction': 'Validation',
                'Early Traction': 'Early Traction',
                'Early Traction → Growth': 'Early Traction',
                'Growth': 'Growth',
                'Growth → Scale': 'Growth',
                'Scale': 'Scale'
            };
            
            const currentStage = stageMapping[stage] || 'Ideation';
            const stageQuestionsList = stageQuestions[currentStage];
            
            if (!stageQuestionsList) {
                return '<p style="color: #6b7280;">No stage-specific recommendations available.</p>';
            }
            
            // Analyze each stage-specific question answer
            stageQuestionsList.forEach(question => {
                const answer = stageSpecificAnswers[question.name];
                if (answer) {
                    // Convert answer to score (1-5 scale)
                    let score = 0;
                    if (question.options && question.options.length > 0) {
                        const optionIndex = question.options.findIndex(option => option === answer);
                        if (optionIndex !== -1) {
                            score = optionIndex + 1; // Convert to 1-5 scale
                        }
                    }
                    
                    // Only recommend areas where they scored 1-3 (need improvement)
                                                if (score >= 1 && score <= 3) {
                                const recommendation = getRecommendationForQuestion(currentStage, question.name, score);
                                if (recommendation) {
                                    const answerText = answer || 'Not specified';
                                    recommendations += `
                                        <div style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid #10b981;">
                                            <h4 style="margin: 0 0 10px 0; color: #374151; font-size: 14px;">${question.label}</h4>
                                            <p style="margin: 0 0 8px 0; color: #6b7280; font-size: 13px;"><strong>Your answer:</strong> ${answerText}</p>
                                            <p style="margin: 0; color: #374151; font-weight: 500;"><strong>Our recommendation:</strong> ${recommendation}</p>
                                        </div>
                                    `;
                                }
                            }
                }
            });
            
            if (!recommendations) {
                recommendations = '<p style="color: #10b981; font-weight: 500;">Great job! Your answers indicate you\'re well-positioned in this stage. Focus on execution and moving to the next phase.</p>';
            }
            
            return recommendations;
        }

        function getRecommendationForQuestion(stage, questionName, score) {
            const recommendations = {
                'Ideation': {
                    'ideation_customer_profile': {
                        1: 'Focus on defining your target customers clearly - this will help you build the right MVP and avoid wasting resources on the wrong audience.',
                        2: 'Validate your customer assumptions through structured discovery - this will enable you to create a compelling value proposition.',
                        3: 'Refine your customer profile based on real feedback - this will help you prioritize features and messaging that resonates.'
                    },
                    'ideation_mvp_scope': {
                        1: 'Define your MVP scope clearly - this will prevent feature creep and help you launch faster with core value.',
                        2: 'Link each feature to a specific problem - this will ensure your MVP addresses real user needs.',
                        3: 'Prioritize features based on user feedback - this will help you build what customers actually want.'
                    },
                    'ideation_business_model': {
                        1: 'Define your business model clearly - this will help you understand revenue streams and pricing strategy.',
                        2: 'Validate key business model assumptions - this will enable you to make informed decisions about partnerships and channels.',
                        3: 'Test different business model options - this will help you find the most sustainable approach.'
                    },
                    'ideation_gtm_thinking': {
                        1: 'Develop your GTM strategy early - this will help you acquire customers efficiently when you launch.',
                        2: 'Test different customer acquisition channels - this will enable you to find the most cost-effective approach.',
                        3: 'Refine your messaging based on market feedback - this will help you connect with your target audience.'
                    },
                    'ideation_team_technical': {
                        1: 'Build technical capabilities in your team - this will enable you to execute your product vision effectively.',
                        2: 'Develop product execution skills - this will help you build and iterate on your MVP quickly.',
                        3: 'Strengthen technical leadership - this will help you make better product decisions.'
                    },
                    'ideation_team_commercial': {
                        1: 'Develop commercial skills in your team - this will enable you to acquire customers and generate revenue.',
                        2: 'Build sales and marketing capabilities - this will help you validate demand and pricing.',
                        3: 'Strengthen commercial leadership - this will help you build sustainable growth.'
                    },
                    'ideation_fundraising_readiness': {
                        1: 'Define your funding needs clearly - this will help you approach the right investors with confidence.',
                        2: 'Prepare your fundraising narrative - this will enable you to communicate your vision effectively.',
                        3: 'Validate your funding assumptions - this will help you raise capital more efficiently.'
                    },
                    'ideation_milestones_progress': {
                        1: 'Set clear milestones and timelines - this will help you track progress and stay focused.',
                        2: 'Define ownership and accountability - this will enable you to execute your plan effectively.',
                        3: 'Establish progress tracking systems - this will help you identify and address blockers early.'
                    }
                },
                'Validation': {
                    'validation_solution_value': {
                        1: 'Test your solution with real users - this will validate that you\'re solving a real problem.',
                        2: 'Measure user engagement and retention - this will prove your solution has value.',
                        3: 'Collect user feedback systematically - this will help you iterate and improve.'
                    },
                    'validation_icp_behaviour': {
                        1: 'Engage with potential customers directly - this will help you understand their needs and behavior.',
                        2: 'Track customer interest signals - this will validate your target market assumptions.',
                        3: 'Refine your ICP based on real data - this will help you focus your efforts effectively.'
                    },
                    'validation_segment_traction': {
                        1: 'Analyze which segments show interest - this will help you focus on the most promising markets.',
                        2: 'Track channel performance - this will enable you to optimize your customer acquisition.',
                        3: 'Monitor competitor activity - this will help you position your solution effectively.'
                    },
                    'validation_mvp_testing': {
                        1: 'Test your MVP with real users - this will identify usability issues and improvement opportunities.',
                        2: 'Iterate based on user feedback - this will help you build a better product.',
                        3: 'Prepare for scale - this will enable you to support more users when you grow.'
                    },
                    'validation_gtm_experimentation': {
                        1: 'Test different GTM strategies - this will help you find what works for your market.',
                        2: 'Measure GTM performance - this will enable you to optimize your customer acquisition.',
                        3: 'Refine your approach based on data - this will help you scale efficiently.'
                    },
                    'validation_traction_signals': {
                        1: 'Track key traction metrics - this will help you measure progress and identify opportunities.',
                        2: 'Analyze user behavior patterns - this will validate your product-market fit.',
                        3: 'Use data to guide decisions - this will help you focus on what drives growth.'
                    },
                    'validation_resource_gaps': {
                        1: 'Identify key capability gaps - this will help you plan your team and partnerships.',
                        2: 'Develop plans to fill gaps - this will enable you to execute your strategy effectively.',
                        3: 'Prioritize resource allocation - this will help you make the most of limited resources.'
                    },
                    'validation_financial_planning': {
                        1: 'Develop financial projections - this will help you plan your growth and funding needs.',
                        2: 'Track key financial metrics - this will enable you to make informed decisions.',
                        3: 'Plan for different scenarios - this will help you prepare for uncertainty.'
                    },
                    'validation_fundraising_preparation': {
                        1: 'Develop your fundraising narrative - this will help you communicate your vision effectively.',
                        2: 'Prepare supporting materials - this will enable you to engage investors confidently.',
                        3: 'Identify target investors - this will help you focus your fundraising efforts.'
                    },
                    'validation_risk_assumption_review': {
                        1: 'Test key business assumptions - this will help you validate your strategy.',
                        2: 'Define clear success metrics - this will enable you to measure progress.',
                        3: 'Use data to guide decisions - this will help you iterate and improve.'
                    }
                },
                'Early Traction': {
                    'early_traction_customer_retention': {
                        1: 'Track customer usage and retention - this will help you understand product-market fit.',
                        2: 'Analyze retention patterns - this will enable you to identify improvement opportunities.',
                        3: 'Implement retention strategies - this will help you build sustainable growth.'
                    },
                    'early_traction_market_signals': {
                        1: 'Identify your strongest customer segments - this will help you focus your efforts effectively.',
                        2: 'Adapt to market changes - this will enable you to stay competitive.',
                        3: 'Refine your positioning - this will help you connect with your target audience.'
                    },
                    'early_traction_product_usage': {
                        1: 'Monitor product performance - this will help you identify and fix issues quickly.',
                        2: 'Address scaling challenges - this will enable you to support more users.',
                        3: 'Optimize user experience - this will help you improve retention and engagement.'
                    },
                    'early_traction_gtm_execution': {
                        1: 'Structure your GTM efforts - this will help you acquire customers systematically.',
                        2: 'Test and optimize channels - this will enable you to scale efficiently.',
                        3: 'Learn from GTM data - this will help you improve your customer acquisition.'
                    },
                    'early_traction_ops_scalability': {
                        1: 'Establish basic systems and processes - this will help you support growth.',
                        2: 'Define roles and responsibilities - this will enable you to scale your team.',
                        3: 'Track operational metrics - this will help you identify improvement opportunities.'
                    },
                    'early_traction_legal_compliance': {
                        1: 'Review legal requirements - this will help you avoid compliance issues.',
                        2: 'Implement basic legal protections - this will enable you to operate confidently.',
                        3: 'Plan for regulatory changes - this will help you stay compliant as you grow.'
                    },
                    'early_traction_activation_monetization': {
                        1: 'Define your value proposition clearly - this will help you convert users to customers.',
                        2: 'Optimize your conversion funnel - this will enable you to monetize more effectively.',
                        3: 'Test pricing strategies - this will help you maximize revenue.'
                    },
                    'early_traction_capability_gaps': {
                        1: 'Identify critical capability gaps - this will help you plan your team and partnerships.',
                        2: 'Develop plans to fill gaps - this will enable you to execute your strategy.',
                        3: 'Prioritize resource allocation - this will help you make the most of limited resources.'
                    },
                    'early_traction_people_culture': {
                        1: 'Define your company culture - this will help you attract and retain the right people.',
                        2: 'Establish basic HR processes - this will enable you to scale your team effectively.',
                        3: 'Build performance feedback systems - this will help you develop your people.'
                    },
                    'early_traction_financial_planning': {
                        1: 'Develop financial projections - this will help you plan your growth and funding needs.',
                        2: 'Track key financial metrics - this will enable you to make informed decisions.',
                        3: 'Plan for different scenarios - this will help you prepare for uncertainty.'
                    },
                    'early_traction_investment_narrative': {
                        1: 'Develop your investment story - this will help you communicate your vision effectively.',
                        2: 'Prepare supporting materials - this will enable you to engage investors confidently.',
                        3: 'Identify target investors - this will help you focus your fundraising efforts.'
                    },
                    'early_traction_strategic_planning': {
                        1: 'Define your strategic priorities - this will help you focus your efforts effectively.',
                        2: 'Align your team around goals - this will enable you to execute more efficiently.',
                        3: 'Track progress systematically - this will help you stay on track.'
                    },
                    'early_traction_scale_readiness': {
                        1: 'Assess your scale readiness - this will help you identify and address blockers.',
                        2: 'Develop scale plans - this will enable you to grow more effectively.',
                        3: 'Build scale capabilities - this will help you support rapid growth.'
                    }
                },
                'Growth': {
                    'growth_customer_retention': {
                        1: 'Implement customer success strategies - this will help you retain and expand customers.',
                        2: 'Track retention metrics - this will enable you to identify improvement opportunities.',
                        3: 'Optimize customer experience - this will help you build loyalty and referrals.'
                    },
                    'growth_competitive_differentiation': {
                        1: 'Define your competitive advantages - this will help you stand out in the market.',
                        2: 'Monitor competitor activity - this will enable you to adapt your positioning.',
                        3: 'Refine your messaging - this will help you connect with your target audience.'
                    },
                    'growth_product_depth': {
                        1: 'Scale your product infrastructure - this will help you support more users.',
                        2: 'Expand product features - this will enable you to serve different customer segments.',
                        3: 'Optimize product performance - this will help you improve user satisfaction.'
                    },
                    'growth_gtm_engine': {
                        1: 'Build repeatable GTM processes - this will help you scale customer acquisition.',
                        2: 'Optimize your sales funnel - this will enable you to convert more prospects.',
                        3: 'Scale your GTM team - this will help you accelerate growth.'
                    },
                    'growth_systems_tooling': {
                        1: 'Implement key systems and tools - this will help you scale operations efficiently.',
                        2: 'Automate repetitive tasks - this will enable you to focus on high-value activities.',
                        3: 'Build dashboards and reporting - this will help you make data-driven decisions.'
                    },
                    'growth_regulatory_compliance': {
                        1: 'Assess compliance requirements - this will help you avoid regulatory issues.',
                        2: 'Implement compliance systems - this will enable you to operate confidently.',
                        3: 'Monitor regulatory changes - this will help you stay compliant as you grow.'
                    },
                    'growth_sustainable_metrics': {
                        1: 'Track sustainable growth metrics - this will help you identify quality growth opportunities.',
                        2: 'Analyze cohort performance - this will enable you to optimize your customer acquisition.',
                        3: 'Use data to guide growth decisions - this will help you scale efficiently.'
                    },
                    'growth_org_structure': {
                        1: 'Define organizational structure - this will help you scale your team effectively.',
                        2: 'Develop leadership capabilities - this will enable you to manage growth.',
                        3: 'Establish decision-making processes - this will help you execute efficiently.'
                    },
                    'growth_financial_discipline': {
                        1: 'Implement financial controls - this will help you manage growth responsibly.',
                        2: 'Track key financial metrics - this will enable you to make informed decisions.',
                        3: 'Plan for different growth scenarios - this will help you prepare for uncertainty.'
                    },
                    'growth_institutional_fundraising': {
                        1: 'Prepare for institutional fundraising - this will help you access growth capital.',
                        2: 'Develop investor relationships - this will enable you to raise funds more efficiently.',
                        3: 'Build board governance - this will help you manage investor relationships.'
                    },
                    'growth_strategic_focus': {
                        1: 'Define strategic priorities - this will help you focus your efforts effectively.',
                        2: 'Align your team around goals - this will enable you to execute more efficiently.',
                        3: 'Track progress systematically - this will help you stay on track.'
                    },
                    'growth_expansion_playbook': {
                        1: 'Develop expansion strategies - this will help you enter new markets.',
                        2: 'Test expansion approaches - this will enable you to find what works.',
                        3: 'Build expansion capabilities - this will help you scale into new markets.'
                    }
                },
                'Scale': {
                    'scale_enterprise_portfolio': {
                        1: 'Segment your customer base - this will help you serve different customer types effectively.',
                        2: 'Develop customer success strategies - this will enable you to retain and expand customers.',
                        3: 'Track customer outcomes - this will help you demonstrate value and build credibility.'
                    },
                    'scale_segment_strategy': {
                        1: 'Prioritize market segments - this will help you focus your expansion efforts.',
                        2: 'Monitor market dynamics - this will enable you to adapt your strategy.',
                        3: 'Refine your positioning - this will help you compete effectively in each segment.'
                    },
                    'scale_market_intelligence': {
                        1: 'Research international markets - this will help you identify expansion opportunities.',
                        2: 'Develop market entry strategies - this will enable you to enter new markets effectively.',
                        3: 'Build local capabilities - this will help you succeed in new markets.'
                    },
                    'scale_platform_ecosystem': {
                        1: 'Develop platform capabilities - this will help you serve more customer types.',
                        2: 'Build integration capabilities - this will enable you to create ecosystem value.',
                        3: 'Scale your infrastructure - this will help you support enterprise customers.'
                    },
                    'scale_international_gtm': {
                        1: 'Adapt GTM for international markets - this will help you acquire customers globally.',
                        2: 'Test different GTM approaches - this will enable you to find what works in each market.',
                        3: 'Scale GTM operations - this will help you accelerate international growth.'
                    },
                    'scale_enterprise_systems': {
                        1: 'Implement enterprise systems - this will help you support larger customers.',
                        2: 'Standardize processes - this will enable you to deliver consistently at scale.',
                        3: 'Build governance frameworks - this will help you manage complex operations.'
                    },
                    'scale_central_data_platform': {
                        1: 'Centralize your data - this will help you make better strategic decisions.',
                        2: 'Build data dashboards - this will enable you to track performance across functions.',
                        3: 'Use data for planning - this will help you make informed strategic decisions.'
                    },
                    'scale_business_leverage': {
                        1: 'Identify leverage points - this will help you optimize your business model.',
                        2: 'Track efficiency metrics - this will enable you to identify improvement opportunities.',
                        3: 'Optimize operations - this will help you improve margins and scale efficiently.'
                    },
                    'scale_org_design': {
                        1: 'Design scalable organization - this will help you support long-term growth.',
                        2: 'Develop succession plans - this will enable you to build sustainable leadership.',
                        3: 'Implement talent development - this will help you build a strong team.'
                    },
                    'scale_capital_allocation': {
                        1: 'Implement capital allocation processes - this will help you invest resources effectively.',
                        2: 'Track capital efficiency - this will enable you to optimize your investments.',
                        3: 'Plan for different scenarios - this will help you manage financial risk.'
                    },
                    'scale_strategic_optionality': {
                        1: 'Develop strategic options - this will help you plan for different futures.',
                        2: 'Engage your board - this will enable you to make informed strategic decisions.',
                        3: 'Plan for strategic outcomes - this will help you maximize long-term value.'
                    },
                    'scale_inorganic_growth': {
                        1: 'Develop partnership strategies - this will help you accelerate growth.',
                        2: 'Build M&A capabilities - this will enable you to pursue strategic opportunities.',
                        3: 'Execute inorganic growth - this will help you scale more quickly.'
                    }
                }
            };
            
            return recommendations[stage]?.[questionName]?.[score] || null;
        }

        function downloadAIReport() {
            const reportText = `
AI-Powered Startup Report
Generated: ${new Date().toLocaleDateString()}

STARTUP OVERVIEW
Based on your diagnostic results, ${answers.companyName || 'your startup'} is currently in the ${stageResult.stage} stage with an overall performance score of ${stageResult.score}/10.

STRATEGIC RECOMMENDATIONS
${generateRecommendations().replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim()}

---
Report generated by Startup Diagnostic Tool
Stage: ${stageResult.stage}
Score: ${stageResult.score}/10
Company: ${answers.companyName || 'N/A'}
            `;
            
            const blob = new Blob([reportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `startup-ai-report-${answers.companyName || 'startup'}-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
